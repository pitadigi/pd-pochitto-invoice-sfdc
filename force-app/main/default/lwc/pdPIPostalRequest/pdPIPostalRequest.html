<!-- sldsValidatorIgnore -->
<template>
  <div class="slds-page-header" role="banner">
    <div class="slds-page-header__row">
      <div class="slds-page-header__col-title">
        <div class="slds-media">
          <div class="slds-media__figure">
            <lightning-icon icon-name="custom:custom105" size="large" alternative-text="郵送依頼"></lightning-icon>
          </div>
          <div class="slds-media__body">
            <div class="slds-page-header__name">
              <div class="slds-page-header__name-title">
                <h1>
                  <span class="slds-page-header__title slds-truncate" title="郵送依頼">郵送依頼</span>
                </h1>
              </div>
            </div>
            <p class="slds-page-header__name-meta">
              <template if:true={isCompleted}>
                郵送依頼はすべて完了
              </template>
              <template if:false={isCompleted}>
                発送待ち郵送依頼 {requestCount} 日分
              </template>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>    
  <div class="c-container slds-theme_default">
    <lightning-tabset>
      <lightning-tab label="発送待ち">
        <lightning-layout horizontal-align="spread" multiple-rows="true">
          <template if:true={postalRequests.data}>
            <template for:each={postalRequests.data} for:item="item">
              <lightning-layout-item padding="around-small" key={item.Id}>
                <lightning-card variant="Narrow" title={item.PostalRequestDate__c} icon-name="standard:date_input">
                  <lightning-button
                    class="slds-m-left_x-small"
                    label="完了"
                    title="郵送依頼を完了にする"
                    icon-name="utility:check"
                    value={item.Id}
                    onclick={handleClickCompleted}
                    slot="actions">
                  </lightning-button>
                  <lightning-layout horizontal-align="spread">
                    <lightning-layout-item padding="around-small">
                      <lightning-input type="number" label="郵送依頼数" value={item.PostalRequestCount__c} read-only="true"></lightning-input>
                    </lightning-layout-item>
                    <lightning-layout-item padding="around-small">
                      <lightning-input type="number" label="発送数" name={item.Id} value={item.IssueCount__c} onchange={handleChangeIssueCount}></lightning-input>
                    </lightning-layout-item>
                  </lightning-layout>
                </lightning-card>
              </lightning-layout-item>
            </template>
          </template>
        </lightning-layout>
      </lightning-tab>
      <lightning-tab label="完了">
        <lightning-layout horizontal-align="spread" multiple-rows="true">
          <template if:true={postalRequestsCompleted.data}>
            <lightning-datatable
              key-field="Id"
              columns={columns}
              data={postalRequestsCompleted.data}
              hide-checkbox-column="true"
              onrowaction={handleRowAction}>
          </lightning-datatable>
          </template>
        </lightning-layout>
      </lightning-tab>
  </lightning-tabset>
</div>
</template>